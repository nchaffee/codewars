-- Century From Year

-- Introduction

-- The first century spans from the year 1 up to and including the 
-- year 100, the second century - from the year 101 up to and including 
-- the year 200, etc.
-- Task

-- Given a year, return the century it is in.
-- Examples

-- 1705 --> 18
-- 1900 --> 19
-- 1601 --> 17
-- 2000 --> 20
SELECT FLOOR((yr - 1)/100) + 1 as century FROM years;

--
select (yr+99)/100 as century from years;
SELECT CEILING(yr/100.00) AS Century from years;
select ceil(yr::real / 100) as century from years;
SELECT CEIL(yr::float/100) AS century FROM years;

--
SELECT
  EXTRACT(CENTURY FROM TO_DATE(yr::text, 'YYYY')) AS century
FROM years;

--
SELECT 
  DATE_PART('century', MAKE_DATE(yr, 1, 1)) AS century
FROM years;

--
select to_char(to_date(yr::text, 'YYYY'), 'CC')::integer as century from years;

--
SELECT
    CAST(
        LEFT(
            CAST(
                DATE_TRUNC(
                    'century',
                    TO_TIMESTAMP(CAST(yr AS text), 'YYYY')
                ) AS text
            ),
            2
        ) AS integer
    ) + 1 AS century
FROM years;

--
SELECT 
  CASE (YR % 100)
  WHEN 0 THEN
    YR / 100
  ELSE
    ( YR / 100 ) + 1
  END 
  AS CENTURY  
FROM YEARS

--
SELECT 
  CASE
   WHEN yr%100 = 0 THEN yr/100
   WHEN yr%100 > 0 THEN yr/100+1
  END 
as century
from years

-- 
CREATE OR REPLACE FUNCTION century(year integer)
RETURNS integer
AS $$
BEGIN 
   IF (year % 100 = 0) THEN
    RETURN (year / 100);
    ELSE
     RETURN FLOOR((year+100)/100) ;
    END IF;
   END;
  $$ LANGUAGE plpgsql;
  
select century(yr) from years

-- 
select case
  when yr%100=0 then CAST(LEFT(yr::text,2)AS INT)
  else trunc((yr/100) + 1) end as century
from years

-- nothing wrong with simple green (maybe sometimes)
SELECT yr,
  CASE
    WHEN yr BETWEEN 0     AND 100   THEN 1
    WHEN yr BETWEEN 101   AND 200   THEN 2
    WHEN yr BETWEEN 201   AND 300   THEN 3
    WHEN yr BETWEEN 301   AND 400   THEN 4
    WHEN yr BETWEEN 401   AND 500   THEN 5
    WHEN yr BETWEEN 501   AND 600   THEN 6
    WHEN yr BETWEEN 601   AND 700   THEN 7
    WHEN yr BETWEEN 701   AND 800   THEN 8
    WHEN yr BETWEEN 801   AND 900   THEN 9
    WHEN yr BETWEEN 901   AND 1000  THEN 10   
    WHEN yr BETWEEN 1001  AND 1100  THEN 11
    WHEN yr BETWEEN 1101  AND 1200  THEN 12
    WHEN yr BETWEEN 1201  AND 1300  THEN 13
    WHEN yr BETWEEN 1301  AND 1400  THEN 14
    WHEN yr BETWEEN 1401  AND 1500  THEN 15 
    WHEN yr BETWEEN 1501  AND 1600  THEN 16
    WHEN yr BETWEEN 1601  AND 1700  THEN 17
    WHEN yr BETWEEN 1701  AND 1800  THEN 18
    WHEN yr BETWEEN 1801  AND 1900  THEN 19
    WHEN yr BETWEEN 1901  AND 2000  THEN 20
    WHEN yr BETWEEN 2001  AND 2100  THEN 21
    WHEN yr BETWEEN 2101  AND 2200  THEN 22
    WHEN yr BETWEEN 2201  AND 2300  THEN 23
    WHEN yr BETWEEN 2301  AND 2400  THEN 24
    WHEN yr BETWEEN 2401  AND 2500  THEN 25
    WHEN yr BETWEEN 2501  AND 2600  THEN 26
    WHEN yr BETWEEN 2601  AND 2700  THEN 27
    WHEN yr BETWEEN 2701  AND 2800  THEN 28
    WHEN yr BETWEEN 2801  AND 2900  THEN 29
    WHEN yr BETWEEN 2901  AND 3000  THEN 30   
    WHEN yr BETWEEN 3001  AND 3100  THEN 31
    WHEN yr BETWEEN 3101  AND 3200  THEN 32
    WHEN yr BETWEEN 3201  AND 3300  THEN 33
    WHEN yr BETWEEN 3301  AND 3400  THEN 34
    WHEN yr BETWEEN 3401  AND 3500  THEN 35 
    WHEN yr BETWEEN 3501  AND 3600  THEN 36
    WHEN yr BETWEEN 3601  AND 3700  THEN 37
    WHEN yr BETWEEN 3701  AND 3800  THEN 38
    WHEN yr BETWEEN 3801  AND 3900  THEN 39
    WHEN yr BETWEEN 3901  AND 4000  THEN 40
    WHEN yr BETWEEN 4001  AND 4100  THEN 41
    WHEN yr BETWEEN 4101  AND 4200  THEN 42
    WHEN yr BETWEEN 4201  AND 4300  THEN 43
    WHEN yr BETWEEN 4301  AND 4400  THEN 44
    WHEN yr BETWEEN 4401  AND 4500  THEN 45
    WHEN yr BETWEEN 4501  AND 4600  THEN 46
    WHEN yr BETWEEN 4601  AND 4700  THEN 47
    WHEN yr BETWEEN 4701  AND 4800  THEN 48
    WHEN yr BETWEEN 4801  AND 4900  THEN 49
    WHEN yr BETWEEN 4901  AND 5000  THEN 50   
    WHEN yr BETWEEN 5001  AND 5100  THEN 51
    WHEN yr BETWEEN 5101  AND 5200  THEN 52
    WHEN yr BETWEEN 5201  AND 5300  THEN 53
    WHEN yr BETWEEN 5301  AND 5400  THEN 54
    WHEN yr BETWEEN 5401  AND 5500  THEN 55 
    WHEN yr BETWEEN 5501  AND 5600  THEN 56
    WHEN yr BETWEEN 5601  AND 5700  THEN 57
    WHEN yr BETWEEN 5701  AND 5800  THEN 58
    WHEN yr BETWEEN 5801  AND 5900  THEN 59
    WHEN yr BETWEEN 5901  AND 6000  THEN 60
    WHEN yr BETWEEN 6001  AND 6100  THEN 61
    WHEN yr BETWEEN 6101  AND 6200  THEN 62
    WHEN yr BETWEEN 6201  AND 6300  THEN 63
    WHEN yr BETWEEN 6301  AND 6400  THEN 64
    WHEN yr BETWEEN 6401  AND 6500  THEN 65
    WHEN yr BETWEEN 6501  AND 6600  THEN 66
    WHEN yr BETWEEN 6601  AND 6700  THEN 67
    WHEN yr BETWEEN 6701  AND 6800  THEN 68
    WHEN yr BETWEEN 6801  AND 6900  THEN 69
    WHEN yr BETWEEN 6901  AND 7000  THEN 70   
    WHEN yr BETWEEN 7001  AND 7100  THEN 71
    WHEN yr BETWEEN 7101  AND 7200  THEN 72
    WHEN yr BETWEEN 7201  AND 7300  THEN 73
    WHEN yr BETWEEN 7301  AND 7400  THEN 74
    WHEN yr BETWEEN 7401  AND 7500  THEN 75 
    WHEN yr BETWEEN 7501  AND 7600  THEN 76
    WHEN yr BETWEEN 7601  AND 7700  THEN 77
    WHEN yr BETWEEN 7701  AND 7800  THEN 78
    WHEN yr BETWEEN 7801  AND 7900  THEN 79
    WHEN yr BETWEEN 7901  AND 8000  THEN 80
    WHEN yr BETWEEN 8001  AND 8100  THEN 81
    WHEN yr BETWEEN 8101  AND 8200  THEN 82
    WHEN yr BETWEEN 8201  AND 8300  THEN 83
    WHEN yr BETWEEN 8301  AND 8400  THEN 84
    WHEN yr BETWEEN 8401  AND 8500  THEN 85
    WHEN yr BETWEEN 8501  AND 8600  THEN 86
    WHEN yr BETWEEN 8601  AND 8700  THEN 87
    WHEN yr BETWEEN 8701  AND 8800  THEN 88
    WHEN yr BETWEEN 8801  AND 8900  THEN 89
    WHEN yr BETWEEN 8901  AND 9000  THEN 90   
    WHEN yr BETWEEN 9001  AND 9100  THEN 91
    WHEN yr BETWEEN 9101  AND 9200  THEN 92
    WHEN yr BETWEEN 9201  AND 9300  THEN 93
    WHEN yr BETWEEN 9301  AND 9400  THEN 94
    WHEN yr BETWEEN 9401  AND 9500  THEN 95 
    WHEN yr BETWEEN 9501  AND 9600  THEN 96
    WHEN yr BETWEEN 9601  AND 9700  THEN 97
    WHEN yr BETWEEN 9701  AND 9800  THEN 98
    WHEN yr BETWEEN 9801  AND 9900  THEN 99
    WHEN yr BETWEEN 9901  AND 10000 THEN 100
    ELSE 0
   END AS century  
FROM years;

